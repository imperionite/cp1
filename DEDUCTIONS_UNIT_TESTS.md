# cp1


## DeductionsService Unit Tests

| Test Method                                | Purpose                                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Outcome                                                                                                                                                                                                                                                                                | Mocked Dependencies                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `loadContributions_success()`              | Verifies that the `loadContributions` method successfully loads contribution data from the JSON file.                                                                                                                                                                                                                                                                                                                                                 | Contributions data is loaded into the `contributions` field of the `DeductionsService` instance.                                                                                                                                                                                                                                                                                                                      
| `calculateWeeklySssDeduction_employeeNotFound()` | Tests that an `IllegalArgumentException` is thrown when an employee is not found during SSS deduction calculation.                                                                                                                                                                                                                                                                                                                                 | An `IllegalArgumentException` is thrown with the message "Employee not found."                                                                                                                                                                                                                                                                                                                                                         | `EmployeeService.getEmployeeByEmployeeNumber()` returns `Optional.empty()`.                                                                                                                                                                                                                                                                                                                                                        |
| `calculateWeeklySssDeduction_invalidDateRange()` | Tests that an `IllegalArgumentException` is thrown when an invalid date range (non-Monday to Sunday) is provided for SSS deduction calculation.                                                                                                                                                                                                                                                                                                            | An `IllegalArgumentException` is thrown with a message indicating an invalid date range.                                                                                                                                                                                                                                                                                                                                     | `EmployeeService.getEmployeeByEmployeeNumber()` is called, but date validation fails.                                                                                                                                                                                                                                                                                                                                               |
| `calculateWeeklyWithholdingTax_success()`| Verifies that withholding tax is calculated successfully for a specific employee.                                                                                                                                                                                                                                                                                                                                                                    | Weekly withholding tax is calculated and returned as a `BigDecimal`.                                                                                                                                                                                                                                                                                                                                                            | `EmployeeService.getEmployeeByEmployeeNumber()` returns an `Optional` containing an `Employee` object with a basic salary. Also calls other service methods like getWeeklyPagIbig, getWeeklyPhilhealth, getWeeklySss with set start and end dates. |
| `calculateWeeklyWithholdingTax_employeeNotFound()` | Tests that an IllegalArgumentException is thrown when an employee number does not exist.                                                                                                                                                                                                                                                                                                                                                    | An IllegalArgumentException is thrown with message "Employee not found".                                                                                                                                                                                                                                                                                                                                                       | `EmployeeService.getEmployeeByEmployeeNumber()` returns Optional.empty().                                                                                                                                                                                                                                                                                                                                                       |
| `calculateWeeklyWithholdingTax_invalidDate()` | Tests that an IllegalArgumentException is thrown when provided start and end dates does not follow the valid week(Monday to Sunday)                                                                                                                                                                                                                                               | An IllegalArgumentException is thrown with an appropriate message about an Invalid date range.                                                                                                                                                                                                                                                                                                                              | `EmployeeService.getEmployeeByEmployeeNumber()` is called, date validation fails.                                                                                                                                                                                                                                                                                                                                               |


![Deductions Service Test](https://drive.google.com/uc?id=1yf0k6VlLKI8Q0YgptaWHz-H-PPNAWnMf)


----

### DeductionsController Unit Tests

| Test Method                                   | Purpose                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Expected Outcome                                                                                                                                                                                                                                                                                                                                                                                                     | Mocked Dependencies                                                                                                                                                                                                                                                                                                                                                                                                                |
| --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `calculateWeeklySssDeduction_employee_success()` | Verifies that an employee can successfully calculate their own SSS deduction.                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly SSS deduction.                                                                                                                                                                                                                                                                                                                | `DeductionsService.calculateWeeklySssDeduction()` returns a `BigDecimal`.                                                                                                                                                                                                                                                                                                                                                         |
| `calculateWeeklySssDeduction_admin_success()`  | Verifies that an admin can successfully calculate the SSS deduction for another employee.                                                                                                                                                                                                                                                                                                                                                                                                                                     | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly SSS deduction.                                                                                                                                                                                                                                                                                                                | `DeductionsService.calculateWeeklySssDeduction()` returns a `BigDecimal`.                                                                                                                                                                                                                                                                                                                                                         |
| `calculateWeeklySssDeduction_unauthorized()`   | Tests that a `401 Unauthorized` response is returned when an unauthenticated user attempts to calculate SSS deduction.                                                                                                                                                                                                                                                                                                                                                                                                       | Returns a `ResponseEntity` with HTTP status `UNAUTHORIZED`.                                                                                                                                                                                                                                                                                                                                                               | N/A                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `calculateWeeklySssDeduction_forbidden()`      | Tests that a `403 Forbidden` response is returned when an employee tries to calculate the SSS deduction for another employee (without admin role).                                                                                                                                                                                                                                                                                                                                                                           | Returns a `ResponseEntity` with HTTP status `FORBIDDEN`.                                                                                                                                                                                                                                                                                                                                                                  | N/A                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `calculateWeeklySssDeduction_badRequest()`     | Tests that a `400 Bad Request` response is returned when the `DeductionsService` throws an `IllegalArgumentException` due to an invalid request.                                                                                                                                                                                                                                                                                                                                                                                    | Returns a `ResponseEntity` with HTTP status `BAD_REQUEST` and the exception message in the body.                                                                                                                                                                                                                                                                                                                          | `DeductionsService.calculateWeeklySssDeduction()` throws `IllegalArgumentException`.                                                                                                                                                                                                                                                                                                                                        |
| `calculateWeeklyPhilHealthDeduction_employee_success()` | Same as SSS test, but for philhealth endpoint | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly philhealth deduction.                                                                                                                                                                                                                                                                                                                | `DeductionsService.calculateWeeklyPhilHealthDeduction()` returns a `BigDecimal`.                                                                                                                                                                                                                                                                                                                                               |
| `calculateWeeklyPagIbigDeduction_employee_success()` | Same as SSS test, but for pag-ibig endpoint | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly pagibig deduction.                                                                                                                                                                                                                                                                                                                | `DeductionsService.calculateWeeklyPagIbigDeduction()` returns a `BigDecimal`.                                                                                                                                                                                                                                                                                                                                               |
| `calculateWeeklyWithholdingTax_employee_success()` | Verify that a employee can call its own withholding Tax | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly Withholding tax. | `DeductionsService.calculateWeeklyWithholdingTax()` returns a `BigDecimal`. |
| `calculateWeeklyWithholdingTax_admin_success()` | Verify that admin can call another employee withholding tax | Returns a `ResponseEntity` with HTTP status `OK` and a JSON response containing the weekly Withholding tax. | `DeductionsService.calculateWeeklyWithholdingTax()` returns a `BigDecimal`. |


![Deductions Controller Test](https://drive.google.com/uc?id=1b4WA4gYIySS3HnQ88gWmqChHQxlUTqss)
